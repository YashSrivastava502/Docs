cur.execute("""
INSERT INTO server_capacity_master
(assetuniquename, total_cpu, total_ram_gb, total_storage_gb)
SELECT
    assetuniquename,
    COALESCE(NULLIF(servercores, '')::NUMERIC, 0),
    COALESCE(NULLIF(servermemory, '')::NUMERIC, 0) / 1024,
    COALESCE(NULLIF(totaldisk, '')::NUMERIC, 0)
FROM inventory
ON CONFLICT (assetuniquename)
DO UPDATE SET
    total_cpu = EXCLUDED.total_cpu,
    total_ram_gb = EXCLUDED.total_ram_gb,
    total_storage_gb = EXCLUDED.total_storage_gb,
    last_synced = CURRENT_TIMESTAMP;
""")
