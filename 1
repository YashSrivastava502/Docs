import csv
import yaml

# Input and output files
input_csv = "fortigate_addresses.csv"   # ğŸ” Your CSV file
output_yaml = "address_objects.yml"     # âœ… Output YAML file

address_objects = []

with open(input_csv, "r") as f:
    reader = csv.DictReader(f)
    for row in reader:
        name = row.get("name", "").strip()
        type_ = row.get("type", "").strip().lower()
        subnet_or_fqdn = row.get("subnet", "").strip()

        # Skip rows missing essential fields
        if not name or not type_ or not subnet_or_fqdn:
            continue

        obj = {
            "name": name,
            "type": type_,
        }

        if type_ == "subnet":
            obj["subnet"] = subnet_or_fqdn
        elif type_ == "fqdn":
            obj["fqdn"] = subnet_or_fqdn
        else:
            continue  # Skip unknown types

        address_objects.append(obj)

# Dump to YAML
with open(output_yaml, "w") as f:
    yaml.dump({"address_objects": address_objects}, f, sort_keys=False, default_flow_style=False)

print(f"âœ… Converted {len(address_objects)} address objects to {output_yaml}")
