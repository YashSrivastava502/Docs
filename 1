import subprocess

ps_script = r'''
$groupMembers = (Get-ADGroup "ParadisoLMS_SSO" -Properties Members).Members
$emails = @()
foreach ($memberDN in $groupMembers) {
    $user = Get-ADUser -Identity $memberDN -Properties mail
    if ($user.mail) {
        $emails += $user.mail
    }
}
$emails
'''

result = subprocess.run(
    ["powershell", "-Command", ps_script],
    capture_output=True, text=True
)

emails = result.stdout.strip().splitlines()
print("Emails in ParadisoLMS_SSO:")
for mail in emails:
    print(mail)
