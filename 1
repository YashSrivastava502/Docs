Start-Process "C:\Temp\AzureSiteRecovery Provider.exe" -ArgumentList "/q /x:C:\Temp\ASR" -Wait
Start-Process "C:\Temp\ASR\setupdr.exe" -ArgumentList "/q /IAcceptEULA" -Wait


& "C:\Program Files\Microsoft Azure Site Recovery Provider\DRConfigurator.exe" `
   /register `
   /VaultCredentialFile:"C:\Temp\use1-dr-asr-vault01_use1-dr-asr-vault@1-tools Tue Sep 16 2025.VaultCredentials"


   Rename-Item "C:\Temp\use1-dr-asr-vault01_use1-dr-asr-vault@1-tools Tue Sep 16 2025.VaultCredentials" "C:\Temp\VaultCreds.vaultcredentials"

   & "C:\Program Files\Microsoft Azure Site Recovery Provider\DRConfigurator.exe" /register /VaultCredentialFile:"C:\Temp\VaultCreds.vaultcredentials"



$session = New-PSSession -ComputerName <VM_Public_IP> -Credential (Get-Credential)
Copy-Item "C:\path\to\file1.txt" -Destination "C:\Temp\" -ToSession $session
Copy-Item "C:\path\to\file2.txt" -Destination "C:\Temp\" -ToSession $session
Remove-PSSession $session


Invoke-WebRequest -Uri https://aka.ms/downloadazcopy-v10-windows -OutFile C:\Temp\azcopy.zip
Expand-Archive C:\Temp\azcopy.zip -DestinationPath C:\Temp\azcopy
setx PATH "$($env:PATH);C:\Temp\azcopy"


"C:\Program Files\Microsoft Azure Site Recovery Provider\DRConfigurator.exe" /r "C:\Temp\MyVault.vaultcredentials" /q


$vaultKey = Get-ChildItem -Path "C:\Temp" -Filter *.VaultCredentials | Select-Object -First 1; if ($vaultKey) { & "C:\Program Files\Microsoft Azure Site Recovery Provider\DRConfigurator.exe" /r $vaultKey.FullName /q } else { Write-Host "‚ùå No VaultCredentials file found in C:\Temp" }



& "C:\Program Files\Microsoft Azure Site Recovery Provider\DRConfigurator.exe" /r "C:\Temp\_usel-dr-asr-vault01-tools_Tue_Sep_16_2025.VaultCredentials" /q
