from pyad import adgroup, aduser

# Load AD group
group = adgroup.ADGroup.from_cn("ParadisoLMS_SSO")

email_list = []

# Iterate through group members
for member in group.get_members():
    if isinstance(member, aduser.ADUser):  # ensure it's a user, not a nested group
        email = member.get_attribute("mail")
        if email:
            email_list.append(email[0])  # email attribute is a list

# Print emails
print("Emails in ParadisoLMS_SSO:")
for mail in email_list:
    print(mail)
