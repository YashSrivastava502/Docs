# === DOMAIN LIST ===
$domains = @(
    "m.cheapoair.com",
    "www.onetravel.com",
    "m.onetravel.com",
    "www.cheapoair.ca",
    "m.cheapoair.ca",
    "cheapoair.co.uk",
    "m.cheapoair.co.uk",
    "www.cheapoair.com/es-us",
    "m.cheapoair.com/es-us",
    "www.cheapoair.mx",
    "m.cheapoair.mx",
    "www.farebuzz.com",
    "m.farebuzz.com",
    "www.insanelycheapflights.com",
    "m.insanelycheapflights.com",
    "www.clubmiles.com"
)

# === SMTP CONFIGURATION ===
$smtpServer = "192.168.1.100"         # Replace with your internal SMTP relay
$smtpPort = 25
$from = "dns-monitor@corp.local"
$to = "admin@corp.local"
$cc = "ITEngbg@corp.local"           # Add ITEngbg as CC
$subject = "DNS FOR FROM DOMAIN NAME"

# === EMAIL BODY HEADER ===
$report = @"
Please review below DNS outputs (all names should resolve to akamaiedge, except clubmiles):

üßæ DNS Lookup Report - $(Get-Date -Format 'yyyy-MM-dd HH:mm:ss')

"@

# === PERFORM LOOKUPS ===
foreach ($domain in $domains) {
    $report += "=== $domain ===`n"
    try {
        $lookup = nslookup $domain 2>&1
        $report += ($lookup -join "`n") + "`n`n"
    } catch {
        $report += "‚ùå Error looking up $domain: $_`n`n"
    }
}

# === SEND EMAIL ===
Send-MailMessage -SmtpServer $smtpServer -Port $smtpPort `
    -From $from -To $to -Cc $cc -Subject $subject -Body $report

Write-Host "üìß DNS report email sent with CC to $cc"
