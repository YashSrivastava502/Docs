

aryaman.local

kushal.local



DC2 (Cloud-based replica)

Hostname: use1-dr-fp-com-local-repl

Role: Secondary Domain Controller with Global Catalog

Replicates all zones from DC1



3.2 Zones and Records:

Each zone includes a set of test A records (e.g., abc.yash.local, xyz.hamed.local)

DNS replication occurs between DC1 and DC2



---

4. Failover Strategy (Planned)

4.1 Goal:

To maintain DNS resolution capability when DC1 becomes unreachable by switching to DR A records and associated CNAMEs on DC2.

4.2 Workflow:

1. Detect DC1 connectivity failure via ping or script


2. Backup current A records from all zones on DC2 into a CSV


3. Delete existing A and CNAME records (except SOA/NS)


4. Use a predefined CSV (records.csv) to:

Create DR A records (e.g., abc-dr.yash.local)

Create CNAMEs (e.g., abc.yash.local pointing to abc-dr.yash.local)




4.3 CSV Format (records.csv):

Name,IP,Zone
abc,10.1.2.3,yash.local
xyz,10.1.2.4,hamed.local


---

5. Fallback Strategy (Planned)

5.1 Goal:

To revert DNS configuration back to its original state when DC1 is back online.

5.2 Workflow:

1. Detect DC1 connectivity restored


2. Delete all *-dr A records and their CNAMEs


3. Restore original A records from backup CSV




---

6. Automation Scripts

PowerShell scripts were developed for both failover and fallback scenarios

Modular design with clear logging and zone-wise handling

Scripts run locally on DC2



---

7. Testing

7.1 Test Environment:

Two Windows Server 2022 VMs

One on-premises and one in Azure VNet (DC1 and DC2)


7.2 Test Cases Executed:

Test Case	Description	Expected Result	Status

DC1 Failure Simulation	Disabled NIC on DC1	DR records created, CNAMEs in place	Passed
DNS Resolution Test	Query abc.yash.local from client	Resolves to abc-dr	Passed
Fallback Simulation	Re-enable NIC on DC1	CNAMEs deleted, original A records restored	Passed
Final DNS Check	Validate zones on DC1/DC2	All original records present	Passed



---

8. Outcome

✅ High Availability of DNS during outages

✅ Zero manual intervention for failover/fallback

✅ Fully automated record handling

✅ Safe, secure, and reversible DNS management



---

9. Next Steps / Recommendations

Integrate notification system (email alerts)

Add error handling & logging to Event Viewer

Schedule scripts via Task Scheduler or Azure Automation

Include partial zone support in next version


